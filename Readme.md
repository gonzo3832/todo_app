# Flaskアプリの作り方　ToDoアプリ編
忘備録としてざっくりまとめる!!!!

0. appの構成案を考える
   ToDoアプリなので、必要な要件は以下の通り。

   上から順番に実装していった。

- ToDoの入力ホーム(create)

- ToDoリストの一覧画面(read)

- 完了したToDoの削除機能(delete)

- 登録したToDoの編集機能(update)<-未実装

  

1. appを分割する粒度を決める
  今回はToDoアプリ自体を最小単位とする。

  

2. ディレクトリ構成を考える
  使用するappは一つだけなので、分割もくそもない。
  保守性を考えて機能分割する癖をつけたいので、以下のようなディレクトリ構成を考える

  

〜ディレクトリ図〜

ToDoアプリをユーザー登録して使えるようにしたい！とかなったら、authorization appを追加し、
リンクをテンプレートに貼れば良い。
こうやって機能拡張していくイメージ。

3. app.pyにcreate_app関数を作る
書くこと：
- flask app のインスタンス化（親app）
- 子appのviews.pyのimport
- register_blueprintメソッドで、機能分割したappと子appを結びつける

その後、.envファイルにcreate_appまでのpathを書いておく

4. (子app)/views.pyでBlueprintを使ってアプリをインスタンス化
5. (子app)/views.pyにエンドポイントを書いてく
一旦最初のエンドポイントができた時点で走らせてみて、エラーチェックするとよい、と思う

6. 入力ホームを作成
6-1. データベースのセットアップ
以下二つのパッケージを使う
- SQLAlchemy: python製O/Rマッパー。要はpythonのコードとSQLを変換してくれるもの。
- flask-migrate:データベースをマイグレーションするflask拡張機能。
 migration=移民、移動
    　要は、DBの内容を保持したまま更新すること。

 SQLAlchemyはDBを読むためのパッケージ
 flask-migrateはDBを変更するためのflask拡張機能
という認識。

利用の流れはP97参照
apps.appの中で、
DB,Migrateをインスタンス化して、Appと連携したら良い

6-2. モデル（データベースの構造）の定義
難しく考えず、要は何の項目を、どのように、データとして保持するか。
ここでは、シンプルにtodoの内容だけを保持する。
todo/models.pyに書いていく。

6-1,6-2が終わったら、flask db init で初期化する。



6-1. フォームの作成
6-1-1
flask-wtfクラスのインスタンス化と、アプリとの紐付け 
フォームを設ける以上、
- 入力データのバリデーション
- CSRF対策
が必要になる。
それをやってくれるのがflask-wtf。

flaskが提供しているのは、webフレームワークとしての最小限の機能
（ルーティング、テンプレート処理）
よって、実装したい機能に応じて拡張機能を追加していく。
ところで、wtfってなんの略なの、、、、
(what the fuck?)

--- flask-wtf利用の流れ ----
p113参照


6-1-2. フォームクラスの作成
クラスとして、別モジュールに書いていく
p114参照
これでフォーム画面が作成できた
次に、同じ画面に追加したToDoのリストを表示するように改良していく。

7. ToDoリストの表示
まず、表示させたいエンドポイントはどこか→index
では、indexエンドポイントの中で、dbからtodoリストを全件取得する
メソッドはこう
次に、ToDo取得したToDoリストをテンプレートに渡して表示する。

8.delete機能の実装
ここでつまづいた
要はボタンごとに異なる処理を実装したいのだが、方法がわからない。
単純に、deleteのエンドポイントを作ってそこに遷移する仕組みをホームに作る
その後、リダイレクトすればOK
このサイトが参考になった
https://myafu-python.com/work/todo/

要件定義

実装
必要なものをリストアップ
フォーム
